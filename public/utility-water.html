<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="Ape's Console">
    <meta name="author" content="">
    <link rel="icon" href="/resources/bootstrap/favicon.ico">

    <title>SmartCom</title>

    <!-- Bootstrap core CSS -->
    <link href="/resources/bootstrap/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">


    <!-- MetisMenu CSS -->
    <link href="/resources/bootstrap/vendor/metisMenu/metisMenu.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="/resources/bootstrap/dist/css/sb-admin-2.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="/resources/bootstrap/vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
	<style>
		.fonty {
			color: #687888;
		}
		.icon {
			width: 40px;
			height: 40px;
			color: green;
		}		
	</style>	
	<!-- Styles -->
	<style>
	#cnsmp-chart {
		width	: 100%;
		height	: 300px;
	}
	#daily-cnsmp-chart {
		width	: 100%;
		height	: 300px;
	}	
	#pie-chart {
		width	: 100%;
		height	: 300px;
	}}
	</style>
	<!-- Resources -->
	<script src="https://www.amcharts.com/lib/3/amcharts.js"></script>
	<script src="https://www.amcharts.com/lib/3/serial.js"></script>
	<script src="https://www.amcharts.com/lib/3/pie.js"></script>
	<script src="https://www.amcharts.com/lib/3/plugins/export/export.min.js"></script>
	<link rel="stylesheet" href="https://www.amcharts.com/lib/3/plugins/export/export.css" type="text/css" media="all" />
	<script src="https://www.amcharts.com/lib/3/themes/light.js"></script>	
  </head>

  <body>

    <div id="wrapper" ng-app="homeApp" ng-controller="homeCtrl">
        <!-- Navigation -->
        <nav class="navbar navbar-default navbar-static-top" role="navigation" style="margin-bottom: 0;  background-color: #687888;">
			<div class="navbar-header">
                 <a class="navbar-brand" style='color: white; font-size: 12px;' href="power">
					<strong style='font-size: 17px; font-style:italic;'>smart<strong style='font-size: 20px; font-style:italic;'>Com</strong> | </strong> <strong> Welcome</strong> : {{name}}
				</a>
            </div>
			<leftmenu></leftmenu>
		</nav>
		<div id="page-wrapper">
			<div class="row">
				<div class="col-lg-12">
					<h1 class="page-header fonty">Water Management</h1>
				</div>
			</div>	
			<div class="row">
				<div class="col-lg-3 col-md-6">
                    <div class="panel panel-green">
                        <div class="panel-heading">
                            <div class="row">							
                                <div class="col-xs-10 text-left">
									<div>Reservoir: <strong>10000 U</strong></div>
                                    <div>Status: <strong>5000 U</strong></div>
									<div>Consumption: <strong>2030 U</strong></div>
                                </div>									
                            </div>
                        </div>
                    </div>
                </div>	
				<div class="col-lg-3 col-md-6">
                    <div class="panel panel-primary">
                        <div class="panel-heading">
                            <div class="row">						
								<div class="col-xs-12 text-left">
									<div>Consumption / Zone</div>
                                    <div>Zone 1: <strong>800 U</strong></div>
									<div>Zone 2: <strong>200 U</strong></div>
									<div>Zone 3: <strong>530 U</strong></div>
									<div>Zone 4: <strong>500 U</strong></div>
                                </div>							
                            </div>
                        </div>
                    </div>
                </div>
			</div>
			<div class="row">
                <div class="col-lg-12">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            Daily Consumption
                        </div>
                        <div class="panel-body">
                            <div id="daily-cnsmp-chart"></div>
                        </div>
                    </div>
                </div>			
			</div>
			<div class="row">
                <div class="col-lg-6">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            Monthly Consumption
                        </div>
                        <div class="panel-body">
                            <div id="cnsmp-chart"></div>
                        </div>
                    </div>
                </div>				
                <div class="col-lg-6">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            Pie Chart
                        </div>
                        <div class="panel-body">
                            <div id="pie-chart"></div>
                        </div>
                    </div>
                </div>				
			</div>		
		</div>
	</div>
	<!-- Angular -->
	<script src="/resources/angular/angular.min.js"></script>
    <!-- jQuery -->
    <script src="/resources/bootstrap/vendor/jquery/jquery.min.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="/resources/bootstrap/vendor/bootstrap/js/bootstrap.min.js"></script>

    <!-- Metis Menu Plugin JavaScript -->
    <script src="/resources/bootstrap/vendor/metisMenu/metisMenu.min.js"></script>

    <!-- Custom Theme JavaScript -->
    <script src="/resources/bootstrap/dist/js/sb-admin-2.js"></script>
  </body>
</html>
<script>
	var home = angular.module('homeApp', []);	
	var displayConsumption = function(){
		var chart = AmCharts.makeChart( "cnsmp-chart", {
			"theme": "light",
			"type": "serial",
			"dataProvider": [
				{
					'_id': 'Zone 1' , value: 5456
				},{
					'_id': 'Zone 2' , value: 4231
				},{
					'_id': 'Zone 3' , value: 4543
				},{
					'_id': 'Zone 4' , value: 1834
				},{
					'_id': 'Common' , value: 3232
				}
			],
			"valueAxes": [{
				"title": "Consumption"
			}],
			"graphs": [{
				"balloonText": "Consumption in [[category]] : [[value]] per Month",
				"fillAlphas": 1,
				"lineAlpha": 0.2,
				"title": "Zone",
				"type": "column",
				"valueField": "value"
			}],
			"rotate": false,
			"categoryField": "_id",
			"categoryAxis": {
				"gridPosition": "start",
				"fillAlpha": 0.05,
				"position": "left",
			},
			"export": {
				"enabled": false
			 }
		});
	}
	var displayPie = function(){
		var chart = AmCharts.makeChart( "pie-chart", {
		  "type": "pie",
		  "theme": "light",
		  "dataProvider": [ {
			"category": "D.T. Well",
			"value": 3.5
		  }, {
			"category": "Rain Water",
			"value": 2.0
		  }, {
			"category": "Recycle",
			"value": 1.0
		  }, {
			"category": "Corp. Supply",
			"value": 2.5
		  } ],
		  "valueField": "value",
		  "titleField": "category",
		  "outlineAlpha": 0.4,
		  "depth3D": 15,
		  "balloonText": "[[title]]<br><span style='font-size:10px'><b>[[value]]</b> ([[percents]]%)</span>",
		  "angle": 30,
		  "export": {
			"enabled": true
		  }
		} );	
	}	
	var hourlyTrend = function(){
		var chart = AmCharts.makeChart("daily-cnsmp-chart", {
			"theme": "light",
			"type": "serial",
			"dataProvider": [{
				"hour": "6:00 AM",
				"zone1": 3.3,
				"zone2": 4.2,
				"zone3": 3.2,
				"zone4": 4.5
			}, {
				"hour": "9:00 AM",
				"zone1": 3.8,
				"zone2": 4.7,
				"zone3": 4.0,
				"zone4": 5.3
			}, {
				"hour": "12:00 PM",
				"zone1": 4.2,
				"zone2": 4.6,
				"zone3": 3.9,
				"zone4": 4.7
			}, {
				"hour": "3:00 PM",
				"zone1": 3.4,
				"zone2": 3.0,
				"zone3": 2.8,
				"zone4": 3.5
			}, {
				"hour": "6:00 PM",
				"zone1": 2.3,
				"zone2": 2.6,
				"zone3": 2.7,
				"zone4": 3.4
			}, {
				"hour": "9:00 PM",
				"zone1": 2.0,
				"zone2": 1.6,
				"zone3": 1.9,
				"zone4": 2.3
			}, {
				"hour": "00:00 AM",
				"zone1": 0.2,
				"zone2": 0.1,
				"zone3": 0.2,
				"zone4": 0.4
			}],
			"valueAxes": [{
				"unit": "%",
				"position": "left",
				"title": "Water Usage",
			}],
			"startDuration": 1,
			"graphs": [{
				"balloonText": "Usage at [[category]] in Zone 1: <b>[[value]]</b>",
				"fillAlphas": 0.9,
				"lineAlpha": 0.2,
				"title": "Zone 1",
				"type": "column",
				"valueField": "zone1"
			}, {
				"balloonText": "Usage at [[category]] in Zone 2: <b>[[value]]</b>",
				"fillAlphas": 0.9,
				"lineAlpha": 0.2,
				"title": "Zone 1",
				"type": "column",
				"valueField": "zone2"
			}, {
				"balloonText": "Usage at [[category]] in Zone 3: <b>[[value]]</b>",
				"fillAlphas": 0.9,
				"lineAlpha": 0.2,
				"title": "Zone 1",
				"type": "column",
				"valueField": "zone3"
			}, {
				"balloonText": "Usage at [[category]] in Zone 4: <b>[[value]]</b>",
				"fillAlphas": 0.9,
				"lineAlpha": 0.2,
				"title": "Zone 4",
				"type": "column",
				"valueField": "zone4"
			}],
			"plotAreaFillAlphas": 0.1,
			"categoryField": "hour",
			"categoryAxis": {
				"gridPosition": "start"
			},
			"export": {
				"enabled": true
			 }

		});
	}
	
	
	home.directive('leftmenu', function($compile) {
		var directive = {};
		directive.restrict = 'E';
		directive.templateUrl = "/resources/templates/utility-left-menu.html";		
		directive.controller = function($scope, $rootScope, $http) {
			$scope.watertab = 'active';			
		};		
		return directive;
	});	
	home.controller('homeCtrl', function($scope, $http) {
		$http.get("/getuser")
		.then(function(response) {
			$scope.name = response.data.name;
			hourlyTrend();
			displayConsumption();
			displayPie();
		});	
	});

</script>
